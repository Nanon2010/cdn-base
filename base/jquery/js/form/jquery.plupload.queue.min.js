!function(n){var a={};function _(l){return plupload.translate(l)||l}n.fn.pluploadQueue=function(d){return d?(this.each(function(){var p,i,o;function s(l){var a;l.status==plupload.DONE&&(a="plupload_done"),l.status==plupload.FAILED&&(a="plupload_failed"),l.status==plupload.QUEUED&&(a="plupload_delete"),l.status==plupload.UPLOADING&&(a="plupload_uploading");var e=n("#"+l.id).attr("class",a).find("a").css("display","block");l.hint&&e.attr("title",l.hint)}function u(){n("span.plupload_total_status",i).html(p.total.percent+"%"),n("div.plupload_progress_bar",i).css("width",p.total.percent+"%"),n("span.plupload_upload_status",i).text(_("Uploaded %d/%d files").replace(/%d\/%d/,p.total.uploaded+"/"+p.files.length))}function l(){var e,d=n("ul.plupload_filelist",i).html(""),t=0;n.each(p.files,function(l,a){e="",a.status==plupload.DONE&&(a.target_name&&(e+='<input type="hidden" name="'+o+"_"+t+'_tmpname" value="'+plupload.xmlEncode(a.target_name)+'" />'),e+='<input type="hidden" name="'+o+"_"+t+'_name" value="'+plupload.xmlEncode(a.name)+'" />',e+='<input type="hidden" name="'+o+"_"+t+'_status" value="'+(a.status==plupload.DONE?"done":"failed")+'" />',t++,n("#"+o+"_count").val(t)),d.append('<li id="'+a.id+'"><div class="plupload_file_name"><span>'+a.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+a.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(a.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+e+"</li>"),s(a),n("#"+a.id+".plupload_delete a").click(function(l){n("#"+a.id).remove(),p.removeFile(a),l.preventDefault()})}),n("span.plupload_total_file_size",i).html(plupload.formatSize(p.total.size)),0===p.total.queued?n("span.plupload_add_text",i).text(_("Add files.")):n("span.plupload_add_text",i).text(p.total.queued+" files queued."),n("a.plupload_start",i).toggleClass("plupload_disabled",p.files.length==p.total.uploaded+p.total.failed),d[0].scrollTop=d[0].scrollHeight,u(),!p.files.length&&p.features.dragdrop&&p.settings.dragdrop&&n("#"+o+"_filelist").append('<li class="plupload_droptext">'+_("Drag files here.")+"</li>")}i=n(this),(o=i.attr("id"))||(o=plupload.guid(),i.attr("id",o)),p=new plupload.Uploader(n.extend({dragdrop:!0,container:o},d)),(a[o]=p).bind("UploadFile",function(l,a){n("#"+a.id).addClass("plupload_current_file")}),p.bind("Init",function(s,l){var a,e;a=o,(e=i).contents().each(function(l,a){(a=n(a)).is(".plupload")||a.remove()}),e.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+_("Select files")+'</div><div class="plupload_header_text">'+_("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+_("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+_("Status")+'</span></div><div class="plupload_file_size">'+_("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add">'+_("Add files")+'</a><a href="#" class="plupload_button plupload_start">'+_("Start upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+a+'_count" name="'+a+'_count" value="0" /></div>'),!d.unique_names&&d.rename&&n("#"+o+"_filelist div.plupload_file_name span",i).live("click",function(l){var e,a,d,t=n(l.target),p="";d=(e=s.getFile(t.parents("li")[0].id)).name,(a=/^(.+)(\.[^.]+)$/.exec(d))&&(d=a[1],p=a[2]),t.hide().after('<input type="text" />'),t.next().val(d).focus().blur(function(){t.show().next().remove()}).keydown(function(l){var a=n(this);13==l.keyCode&&(l.preventDefault(),e.name=a.val()+p,t.text(e.name),a.blur())})}),n("a.plupload_add",i).attr("id",o+"_browse"),s.settings.browse_button=o+"_browse",s.features.dragdrop&&s.settings.dragdrop&&(s.settings.drop_element=o+"_filelist",n("#"+o+"_filelist").append('<li class="plupload_droptext">'+_("Drag files here.")+"</li>")),n("#"+o+"_container").attr("title","Using runtime: "+l.runtime),n("a.plupload_start",i).click(function(l){n(this).hasClass("plupload_disabled")||p.start(),l.preventDefault()}),n("a.plupload_stop",i).click(function(l){l.preventDefault(),p.stop()}),n("a.plupload_start",i).addClass("plupload_disabled")}),p.init(),p.bind("Error",function(l,a){var e,d=a.file;d&&(e=a.message,a.details&&(e+=" ("+a.details+")"),a.code==plupload.FILE_SIZE_ERROR&&alert(_("Error: File too large: ")+d.name),a.code==plupload.FILE_EXTENSION_ERROR&&alert(_("Error: Invalid file extension: ")+d.name),d.hint=e,n("#"+d.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",e))}),p.bind("StateChanged",function(){p.state===plupload.STARTED?(n("li.plupload_delete a,div.plupload_buttons",i).hide(),n("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",i).css("display","block"),n("span.plupload_upload_status",i).text("Uploaded "+p.total.uploaded+"/"+p.files.length+" files"),d.multiple_queues&&n("span.plupload_total_status,span.plupload_total_file_size",i).show()):(l(),n("a.plupload_stop,div.plupload_progress",i).hide(),n("a.plupload_delete",i).css("display","block"))}),p.bind("QueueChanged",l),p.bind("FileUploaded",function(l,a){s(a)}),p.bind("UploadProgress",function(l,a){n("#"+a.id+" div.plupload_file_status",i).html(a.percent+"%"),s(a),u(),d.multiple_queues&&p.total.uploaded+p.total.failed==p.files.length&&(n(".plupload_buttons,.plupload_upload_status",i).css("display","inline"),n(".plupload_start",i).addClass("plupload_disabled"),n("span.plupload_total_status,span.plupload_total_file_size",i).hide())}),d.setup&&d.setup(p)}),this):a[n(this[0]).attr("id")]}}(jQuery);